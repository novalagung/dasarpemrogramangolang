<!DOCTYPE HTML>
<html lang>
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Google API Search Dengan Timeout - Dasar Pemrograman Golang</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content>
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-docsearch-v3/style.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-disqus/plugin.css" media="print" onload="this.media='all'">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css" media="print" onload="this.media='all'">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css" media="print" onload="this.media='all'">
                
            
        

    

    
        
        <link rel="stylesheet" href="style-website-v3.css">
        
    

        
    
    
    <meta name="google-site-verification" content="UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE">
    
    <meta name="og:image" content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg">
    
    <meta name="twitter:image" content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg">
    
    
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="D-golang-web-socket-chatting-app.html">
    
    
    <link rel="prev" href="D-insert-1mil-csv-record-into-db-in-a-minute.html">
    


    <script async defer src="https://buttons.github.io/buttons.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-MZ74P74K72"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'G-MZ74P74K72');
		</script></head>
    <body>
        
<div class="book">
    <div class="book-summary"><div id="book-search-input"><div id="book-doc-search-input"></div></div>
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Dasar Pemrograman Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="CHANGELOG.html">
            
                <a href="CHANGELOG.html">
            
                    
                    Version Changelogs &amp; Updates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="download-ebook.html">
            
                <a href="download-ebook.html">
            
                    
                    Download Ebook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="CONTRIBUTING.html">
            
                <a href="CONTRIBUTING.html">
            
                    
                    Author &amp; Contributors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="DISTRIBUTION.html">
            
                <a href="DISTRIBUTION.html">
            
                    
                    Lisensi dan Distribusi Konten
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1">
            
                <span>
            
                    
                    Referensi Belajar Lainnya
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1">
            
                <a target="_blank" href="https://dasarpemrogramanpython.novalagung.com/">
            
                    
                    &#x1F4D6; Dasar Pemrograman Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2">
            
                <a target="_blank" href="https://dasarpemrogramanrust.novalagung.com/">
            
                    
                    &#x1F4D6; Dasar Pemrograman Rust
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3">
            
                <a target="_blank" href="https://howto.novalagung.com">
            
                    
                    &#x1F4D6; How To
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4">
            
                <a target="_blank" href="https://www.udemy.com/course/praktis-belajar-docker-dan-kubernetes-untuk-pemula/">
            
                    
                    &#x25B6;&#xFE0F; Udemy Course: Belajar Docker &amp; Kubernetes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1">
            
                <span>
            
                    
                    A. Pemrograman Go Dasar
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="1-berkenalan-dengan-golang.html">
            
                <a href="1-berkenalan-dengan-golang.html">
            
                    
                    A.1. Belajar Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="2-instalasi-golang.html">
            
                <a href="2-instalasi-golang.html">
            
                    
                    A.2. Instalasi Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="A-setup-go-project-dengan-go-modules.html">
            
                <a href="A-setup-go-project-dengan-go-modules.html">
            
                    
                    A.3. Setup Go Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="A-gopath-dan-workspace.html">
            
                <a href="A-gopath-dan-workspace.html">
            
                    
                    A.4. Setup GOPATH dan Workspace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="A-instalasi-editor.html">
            
                <a href="A-instalasi-editor.html">
            
                    
                    A.5. Instalasi Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="A-go-command.html">
            
                <a href="A-go-command.html">
            
                    
                    A.6. Go Command
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="A-hello-world.html">
            
                <a href="A-hello-world.html">
            
                    
                    A.7. Program Pertama: Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.8" data-path="A-komentar.html">
            
                <a href="A-komentar.html">
            
                    
                    A.8. Komentar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.9" data-path="A-variabel.html">
            
                <a href="A-variabel.html">
            
                    
                    A.9. Variabel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.10" data-path="A-tipe-data.html">
            
                <a href="A-tipe-data.html">
            
                    
                    A.10. Tipe Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.11" data-path="A-konstanta.html">
            
                <a href="A-konstanta.html">
            
                    
                    A.11. Konstanta
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.12" data-path="A-operator.html">
            
                <a href="A-operator.html">
            
                    
                    A.12. Operator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.13" data-path="A-seleksi-kondisi.html">
            
                <a href="A-seleksi-kondisi.html">
            
                    
                    A.13. Seleksi Kondisi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.14" data-path="A-perulangan.html">
            
                <a href="A-perulangan.html">
            
                    
                    A.14. Perulangan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.15" data-path="A-array.html">
            
                <a href="A-array.html">
            
                    
                    A.15. Array
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.16" data-path="A-slice.html">
            
                <a href="A-slice.html">
            
                    
                    A.16. Slice
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.17" data-path="A-map.html">
            
                <a href="A-map.html">
            
                    
                    A.17. Map
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.18" data-path="A-fungsi.html">
            
                <a href="A-fungsi.html">
            
                    
                    A.18. Fungsi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.19" data-path="A-fungsi-multiple-return.html">
            
                <a href="A-fungsi-multiple-return.html">
            
                    
                    A.19. Fungsi Multiple Return
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.20" data-path="A-fungsi-variadic.html">
            
                <a href="A-fungsi-variadic.html">
            
                    
                    A.20. Fungsi Variadic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.21" data-path="A-fungsi-closure.html">
            
                <a href="A-fungsi-closure.html">
            
                    
                    A.21. Fungsi Closure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.22" data-path="A-fungsi-sebagai-parameter.html">
            
                <a href="A-fungsi-sebagai-parameter.html">
            
                    
                    A.22. Fungsi Sebagai parameter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.23" data-path="A-pointer.html">
            
                <a href="A-pointer.html">
            
                    
                    A.23. Pointer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.24" data-path="A-struct.html">
            
                <a href="A-struct.html">
            
                    
                    A.24. Struct
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.25" data-path="A-method.html">
            
                <a href="A-method.html">
            
                    
                    A.25. Method
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.26" data-path="A-properti-public-dan-private.html">
            
                <a href="A-properti-public-dan-private.html">
            
                    
                    A.26. Properti Public dan Private (Exported vs Unexported)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.27" data-path="A-interface.html">
            
                <a href="A-interface.html">
            
                    
                    A.27. Interface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.28" data-path="A-interface-kosong.html">
            
                <a href="A-interface-kosong.html">
            
                    
                    A.28. Any / interface{} / Interface Kosong
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.29" data-path="A-reflect.html">
            
                <a href="A-reflect.html">
            
                    
                    A.29. Reflect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.30" data-path="A-goroutine.html">
            
                <a href="A-goroutine.html">
            
                    
                    A.30. Goroutine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.31" data-path="A-channel.html">
            
                <a href="A-channel.html">
            
                    
                    A.31. Channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.32" data-path="A-buffered-channel.html">
            
                <a href="A-buffered-channel.html">
            
                    
                    A.32. Buffered Channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.33" data-path="A-channel-select.html">
            
                <a href="A-channel-select.html">
            
                    
                    A.33. Channel - Select
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.34" data-path="A-channel-range-close.html">
            
                <a href="A-channel-range-close.html">
            
                    
                    A.34. Channel - Range &amp; Close
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.35" data-path="A-channel-timeout.html">
            
                <a href="A-channel-timeout.html">
            
                    
                    A.35. Channel - Timeout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.36" data-path="A-defer-exit.html">
            
                <a href="A-defer-exit.html">
            
                    
                    A.36. Defer &amp; Exit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.37" data-path="A-error-panic-recover.html">
            
                <a href="A-error-panic-recover.html">
            
                    
                    A.37. Error, Panic, &amp; Recover
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.38" data-path="A-string-format.html">
            
                <a href="A-string-format.html">
            
                    
                    A.38. Layout Format String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.39" data-path="A-random.html">
            
                <a href="A-random.html">
            
                    
                    A.39. Random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.40" data-path="A-time-parsing-format.html">
            
                <a href="A-time-parsing-format.html">
            
                    
                    A.40. Time, Parsing Time, &amp; Format Time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.41" data-path="A-timer-ticker-scheduler.html">
            
                <a href="A-timer-ticker-scheduler.html">
            
                    
                    A.41. Timer, Ticker, &amp; Scheduler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.42" data-path="A-time-duration.html">
            
                <a href="A-time-duration.html">
            
                    
                    A.42. Time Duration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.43" data-path="A-data-type-conversion.html">
            
                <a href="A-data-type-conversion.html">
            
                    
                    A.43. Konversi Antar Tipe Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.44" data-path="A-strings.html">
            
                <a href="A-strings.html">
            
                    
                    A.44. Fungsi String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.45" data-path="A-regex.html">
            
                <a href="A-regex.html">
            
                    
                    A.45. Regexp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.46" data-path="A-encoding-base64.html">
            
                <a href="A-encoding-base64.html">
            
                    
                    A.46. Encode - Decode Base64
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.47" data-path="A-hash-sha1.html">
            
                <a href="A-hash-sha1.html">
            
                    
                    A.47. Hash Sha1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.48" data-path="A-command-line-args-flag.html">
            
                <a href="A-command-line-args-flag.html">
            
                    
                    A.48. Arguments &amp; Flag
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.49" data-path="A-exec.html">
            
                <a href="A-exec.html">
            
                    
                    A.49. Exec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.50" data-path="A-file.html">
            
                <a href="A-file.html">
            
                    
                    A.50. File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.51" data-path="A-web-server.html">
            
                <a href="A-web-server.html">
            
                    
                    A.51. Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.52" data-path="A-url-parsing.html">
            
                <a href="A-url-parsing.html">
            
                    
                    A.52. URL Parsing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.53" data-path="A-json.html">
            
                <a href="A-json.html">
            
                    
                    A.53. JSON Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.54" data-path="A-web-service-api.html">
            
                <a href="A-web-service-api.html">
            
                    
                    A.54. Web Service API Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.55" data-path="A-client-http-request-simple.html">
            
                <a href="A-client-http-request-simple.html">
            
                    
                    A.55. Simple Client HTTP Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.56" data-path="A-sql.html">
            
                <a href="A-sql.html">
            
                    
                    A.56. SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.57" data-path="A-mongodb.html">
            
                <a href="A-mongodb.html">
            
                    
                    A.57. NoSQL MongoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.58" data-path="A-unit-test.html">
            
                <a href="A-unit-test.html">
            
                    
                    A.58. Unit Test
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.59" data-path="A-waitgroup.html">
            
                <a href="A-waitgroup.html">
            
                    
                    A.59. sync.WaitGroup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.60" data-path="A-mutex.html">
            
                <a href="A-mutex.html">
            
                    
                    A.60. sync.Mutex
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.61" data-path="A-go-vendoring.html">
            
                <a href="A-go-vendoring.html">
            
                    
                    A.61. Go Vendoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.62" data-path="A-concurrency-pipeline.html">
            
                <a href="A-concurrency-pipeline.html">
            
                    
                    A.62. Concurrency Pattern: Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.63" data-path="A-simplified-fan-in-fan-out-pipeline.html">
            
                <a href="A-simplified-fan-in-fan-out-pipeline.html">
            
                    
                    A.63. Concurrency Pattern: Simplified Fan-in Fan-out Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.64" data-path="A-pipeline-context-cancellation.html">
            
                <a href="A-pipeline-context-cancellation.html">
            
                    
                    A.64. Concurrency Pattern: Context Cancellation Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.65" data-path="A-golang-generics.html">
            
                <a href="A-golang-generics.html">
            
                    
                    A.65. Go Generics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1">
            
                <span>
            
                    
                    B. Pemrograman Web Go Dasar
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="B-golang-web-hello-world.html">
            
                <a href="B-golang-web-hello-world.html">
            
                    
                    B.1. Golang Web App: Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="B-routing-http-handlefunc.html">
            
                <a href="B-routing-http-handlefunc.html">
            
                    
                    B.2. Routing http.HandleFunc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="B-routing-static-assets.html">
            
                <a href="B-routing-static-assets.html">
            
                    
                    B.3. Routing Static Assets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="B-template-render-html.html">
            
                <a href="B-template-render-html.html">
            
                    
                    B.4. Template: Render HTML Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="B-template-render-partial-html.html">
            
                <a href="B-template-render-partial-html.html">
            
                    
                    B.5. Template: Render Partial HTML Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="B-template-actions-variables.html">
            
                <a href="B-template-actions-variables.html">
            
                    
                    B.6. Template: Actions &amp; Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.7" data-path="B-template-functions.html">
            
                <a href="B-template-functions.html">
            
                    
                    B.7. Template: Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.8" data-path="B-template-custom-functions.html">
            
                <a href="B-template-custom-functions.html">
            
                    
                    B.8. Template: Custom Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.9" data-path="B-render-specific-html-template.html">
            
                <a href="B-render-specific-html-template.html">
            
                    
                    B.9. Template: Render Specific HTML Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.10" data-path="B-render-html-string.html">
            
                <a href="B-render-html-string.html">
            
                    
                    B.10. Template: Render HTML String
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.11" data-path="B-http-method-basic.html">
            
                <a href="B-http-method-basic.html">
            
                    
                    B.11. HTTP Method: POST &amp; GET
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.12" data-path="B-form-value.html">
            
                <a href="B-form-value.html">
            
                    
                    B.12. Form Value
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.13" data-path="B-form-upload-file.html">
            
                <a href="B-form-upload-file.html">
            
                    
                    B.13. Form Upload File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.14" data-path="B-ajax-json-payload.html">
            
                <a href="B-ajax-json-payload.html">
            
                    
                    B.14. AJAX JSON Payload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.15" data-path="B-ajax-json-response.html">
            
                <a href="B-ajax-json-response.html">
            
                    
                    B.15. AJAX JSON Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.16" data-path="B-ajax-multi-upload.html">
            
                <a href="B-ajax-multi-upload.html">
            
                    
                    B.16. AJAX Multiple File Upload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.17" data-path="B-download-file.html">
            
                <a href="B-download-file.html">
            
                    
                    B.17. Download File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.18" data-path="B-http-basic-auth.html">
            
                <a href="B-http-basic-auth.html">
            
                    
                    B.18. HTTP Basic Auth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.19" data-path="B-middleware-using-http-handler.html">
            
                <a href="B-middleware-using-http-handler.html">
            
                    
                    B.19. Middleware http.Handler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.20" data-path="B-custom-mux-multiplexer.html">
            
                <a href="B-custom-mux-multiplexer.html">
            
                    
                    B.20. Custom Multiplexer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.21" data-path="B-cookie.html">
            
                <a href="B-cookie.html">
            
                    
                    B.21. HTTP Cookie
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.22" data-path="B-simple-configuration.html">
            
                <a href="B-simple-configuration.html">
            
                    
                    B.22. Simple Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.23" data-path="B-server-handler-http-request-cancellation.html">
            
                <a href="B-server-handler-http-request-cancellation.html">
            
                    
                    B.23. Server Handler HTTP Request Cancellation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1">
            
                <span>
            
                    
                    C. Pemrograman Go Lanjut
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="C-project-layout-structure.html">
            
                <a href="C-project-layout-structure.html">
            
                    
                    C.1. Project Layout Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="C-golang-web-framework.html">
            
                <a href="C-golang-web-framework.html">
            
                    
                    C.2. Go Web Framework
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="C-echo-routing.html">
            
                <a href="C-echo-routing.html">
            
                    
                    C.3. Echo Framework &amp; Routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="C-parsing-http-request-payload-echo.html">
            
                <a href="C-parsing-http-request-payload-echo.html">
            
                    
                    C.4. Parsing HTTP Request Payload (Echo)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="C-http-request-payload-validation.html">
            
                <a href="C-http-request-payload-validation.html">
            
                    
                    C.5. HTTP Request Payload Validation (Validator v9, Echo)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.6" data-path="C-http-error-handling.html">
            
                <a href="C-http-error-handling.html">
            
                    
                    C.6. HTTP Error Handling (Validator v9, Echo)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.7" data-path="C-echo-template-rendering.html">
            
                <a href="C-echo-template-rendering.html">
            
                    
                    C.7. Template Rendering in Echo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.8" data-path="C-advanced-middleware-and-logging.html">
            
                <a href="C-advanced-middleware-and-logging.html">
            
                    
                    C.8. Advanced Middleware &amp; Logging (Logrus, Echo Logger)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.9" data-path="C-flag-parser.html">
            
                <a href="C-flag-parser.html">
            
                    
                    C.9. CLI Flag Parser (Kingpin)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.10" data-path="C-advanced-configuration-viper.html">
            
                <a href="C-advanced-configuration-viper.html">
            
                    
                    C.10. Advanced Configuration: Viper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.11" data-path="C-best-practice-configuration-env-var.html">
            
                <a href="C-best-practice-configuration-env-var.html">
            
                    
                    C.11. Best Practice Configuration: Environment Variable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.12" data-path="C-securecookie.html">
            
                <a href="C-securecookie.html">
            
                    
                    C.12. Secure Cookie (Gorilla Securecookie)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.13" data-path="C-session.html">
            
                <a href="C-session.html">
            
                    
                    C.13. Session (Gorilla Session)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.14" data-path="C-cors-preflight-request.html">
            
                <a href="C-cors-preflight-request.html">
            
                    
                    C.14. CORS &amp; Preflight Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.15" data-path="C-csrf.html">
            
                <a href="C-csrf.html">
            
                    
                    C.15. CSRF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.16" data-path="C-secure-middleware.html">
            
                <a href="C-secure-middleware.html">
            
                    
                    C.16. Secure Middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.17" data-path="C-http-gzip-compression.html">
            
                <a href="C-http-gzip-compression.html">
            
                    
                    C.17. HTTP Gzip Compression (gziphandler)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.18" data-path="C-send-email.html">
            
                <a href="C-send-email.html">
            
                    
                    C.18. Send Mail (net/smtp, Gomail v2)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.19" data-path="C-read-write-excel-xlsx-file.html">
            
                <a href="C-read-write-excel-xlsx-file.html">
            
                    
                    C.19. Read &amp; Write Excel XLSX File (Excelize)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.20" data-path="C-write-pdf-file.html">
            
                <a href="C-write-pdf-file.html">
            
                    
                    C.20. Write PDF File (gofpdf)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.21" data-path="C-convert-html-to-pdf.html">
            
                <a href="C-convert-html-to-pdf.html">
            
                    
                    C.21. Convert HTML to PDF (go-wkhtmltopdf)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.22" data-path="C-scraping-parsing-html.html">
            
                <a href="C-scraping-parsing-html.html">
            
                    
                    C.22. Scraping &amp; Parsing HTML (goquery)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.23" data-path="C-xml-parser.html">
            
                <a href="C-xml-parser.html">
            
                    
                    C.23. Parse &amp; Generate XML (etree)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.24" data-path="C-https-tls.html">
            
                <a href="C-https-tls.html">
            
                    
                    C.24. HTTPS/TLS Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.25" data-path="C-http2-server-push.html">
            
                <a href="C-http2-server-push.html">
            
                    
                    C.25. HTTP/2 &amp; HTTP/2 Server Push
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.26" data-path="C-client-http-request-advanced.html">
            
                <a href="C-client-http-request-advanced.html">
            
                    
                    C.26. Advanced Client HTTP Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.27" data-path="C-secure-insecure-client-http-request.html">
            
                <a href="C-secure-insecure-client-http-request.html">
            
                    
                    C.27. Secure &amp; Insecure Client HTTP Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.28" data-path="C-golang-ftp.html">
            
                <a href="C-golang-ftp.html">
            
                    
                    C.28. FTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.29" data-path="C-golang-ssh-sftp.html">
            
                <a href="C-golang-ssh-sftp.html">
            
                    
                    C.29. SSH &amp; SFTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.30" data-path="C-golang-protobuf-implementation.html">
            
                <a href="C-golang-protobuf-implementation.html">
            
                    
                    C.30. Protobuf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.31" data-path="C-golang-grpc-protobuf.html">
            
                <a href="C-golang-grpc-protobuf.html">
            
                    
                    C.31. gRPC + Protobuf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.32" data-path="C-golang-jwt.html">
            
                <a href="C-golang-jwt.html">
            
                    
                    C.32. JSON Web Token (JWT)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.33" data-path="C-golang-ldap-authentication.html">
            
                <a href="C-golang-ldap-authentication.html">
            
                    
                    C.33. LDAP Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.34" data-path="C-golang-sso-saml-sp.html">
            
                <a href="C-golang-sso-saml-sp.html">
            
                    
                    C.34. SSO SAML (Service Provider)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.35" data-path="C-dockerize-golang.html">
            
                <a href="C-dockerize-golang.html">
            
                    
                    C.35. Dockerize Aplikasi Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.36" data-path="C-golang-redis.html">
            
                <a href="C-golang-redis.html">
            
                    
                    C.36. Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.37" data-path="C-singleflight.html">
            
                <a href="C-singleflight.html">
            
                    
                    C.37. Singleflight
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.38" data-path="C-golang-aws-s3.html">
            
                <a href="C-golang-aws-s3.html">
            
                    
                    C.38. AWS S3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1">
            
                <span>
            
                    
                    D. Studi Kasus
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="D-insert-1mil-csv-record-into-db-in-a-minute.html">
            
                <a href="D-insert-1mil-csv-record-into-db-in-a-minute.html">
            
                    
                    D.1. Insert 1 Juta Data dari File CSV Ke Database Server, Menggunakan Teknik Worker Pool, Database Connection Pool, dan Mekanisme Failover
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="6.1.2" data-path="D-google-api-search.html">
            
                <a href="D-google-api-search.html">
            
                    
                    D.2. Google API Search Dengan Timeout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="D-golang-web-socket-chatting-app.html">
            
                <a href="D-golang-web-socket-chatting-app.html">
            
                    
                    D.3. Web Socket: Chatting App
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".">D.2. Google API Search Dengan Timeout</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h1 id="d2-google-api-search-dengan-timeout">D.2. Google API Search Dengan Timeout</h1>
<p>Pada chapter ini kita akan mencoba studi kasus yaitu membuat web service API untuk <em>wrap</em> pencarian ke Google Search API.</p>
<p>Proses pembelajaran dilakukan dengan praktek membuat sebuah aplikasi web service kecil, yang tugasnya melakukan pencarian data. Nantinya akan dibuat juga middleware <code>MiddlewareUtility</code>, tugasnya menyisipkan informasi origin dispatcher request, ke dalam context request, sebelum akhirnya sampai pada handler endpoint yg sedang diakses.</p>
<h2 id="d21-context-value">D.2.1. Context Value</h2>
<p>Ok, langsung saja, siapkan folder project baru dengan struktur seperti berikut.</p>
<pre><code class="lang-bash">mkdir chapter<span class="hljs-_">-d</span>2
<span class="hljs-built_in">cd</span> chapter<span class="hljs-_">-d</span>2
go mod init chapter<span class="hljs-_">-d</span>2

<span class="hljs-comment"># then prepare underneath structures</span>
tree .
.
&#x251C;&#x2500;&#x2500; main.go
&#x2514;&#x2500;&#x2500; middleware.go

0 directories, 2 files
</code></pre>
<p>Pada file <code>middleware.go</code> isi dengan <code>CustomMux</code> yang pada pembahasan-pembahasan sebelumnya sudah pernah kita gunakan.</p>
<pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;net/http&quot;</span>

<span class="hljs-keyword">type</span> CustomMux <span class="hljs-keyword">struct</span> {
    http.ServeMux
    middlewares []<span class="hljs-keyword">func</span>(next http.Handler) http.Handler
}

<span class="hljs-keyword">func</span> (c *CustomMux) RegisterMiddleware(next <span class="hljs-keyword">func</span>(next http.Handler) http.Handler) {
    c.middlewares = <span class="hljs-built_in">append</span>(c.middlewares, next)
}

<span class="hljs-keyword">func</span> (c *CustomMux) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    <span class="hljs-keyword">var</span> current http.Handler = &amp;c.ServeMux

    <span class="hljs-keyword">for</span> _, next := <span class="hljs-keyword">range</span> c.middlewares {
        current = next(current)
    }

    current.ServeHTTP(w, r)
}
</code></pre>
<p>Lalu pada file <code>main.go</code>, buat satu buah endpoint <code>/api/search</code>, dengan isi handler menampilkan data <code>from</code> yang diambil dari request context. Data <code>from</code> ini di set ke dalam request context oleh middleware <code>MiddlewareUtility</code>.</p>
<pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;context&quot;</span>
    <span class="hljs-string">&quot;io&quot;</span>
    <span class="hljs-string">&quot;fmt&quot;</span>
    <span class="hljs-string">&quot;errors&quot;</span>
    <span class="hljs-string">&quot;time&quot;</span>
    <span class="hljs-string">&quot;net/http&quot;</span>
)

<span class="hljs-keyword">type</span> M <span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}

<span class="hljs-keyword">func</span> main() {
    mux := <span class="hljs-built_in">new</span>(CustomMux)
    mux.RegisterMiddleware(MiddlewareUtility)

    mux.HandleFunc(<span class="hljs-string">&quot;/api/search&quot;</span>, <span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        from := r.Context().Value(<span class="hljs-string">&quot;from&quot;</span>).(<span class="hljs-keyword">string</span>)
        w.Write([]<span class="hljs-keyword">byte</span>(from))
    })

    server := <span class="hljs-built_in">new</span>(http.Server)
    server.Handler = mux
    server.Addr = <span class="hljs-string">&quot;:80&quot;</span>

    fmt.Println(<span class="hljs-string">&quot;Starting server at&quot;</span>, server.Addr)
    server.ListenAndServe()
}
</code></pre>
<p>Cara mengakses context request adalah lewat method <code>.Context()</code> milik objek request. Lalu chain dengan method <code>Value()</code> untuk mengambil data sesuai dengan key yang disisipkan pada parameter.</p>
<p>Untuk sekarang, tugas dari endpoint <code>/api/search</code> hanya menampilkan data tersebut, tidak lebih.</p>
<p>Selanjutnya siapkan middleware <code>MiddlewareUtility</code>. Di dalamnya, ada pengecekan header <code>Referer</code>, jika ada maka dijadikan value data <code>from</code> (yang kemudian disimpan pada context); sedangkan jika tidak ada maka value-nya berasal dari property <code>.Host</code> milik objek request.</p>
<pre><code class="lang-go"><span class="hljs-keyword">func</span> MiddlewareUtility(next http.Handler) http.Handler {
    <span class="hljs-keyword">return</span> http.HandlerFunc(<span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        ctx := r.Context()
        <span class="hljs-keyword">if</span> ctx == <span class="hljs-literal">nil</span> {
            ctx = context.Background()
        }

        from := r.Header.Get(<span class="hljs-string">&quot;Referer&quot;</span>)
        <span class="hljs-keyword">if</span> from == <span class="hljs-string">&quot;&quot;</span> {
            from = r.Host
        }

        ctx = context.WithValue(ctx, <span class="hljs-string">&quot;from&quot;</span>, from)

        requestWithContext := r.WithContext(ctx)
        next.ServeHTTP(w, requestWithContext)
    })
}
</code></pre>
<p>Objek request context bisa didapat lewat pengaksesan method <code>.Context()</code> milik <code>*http.Request</code>. Objek ini bertipe <code>context.Context</code> dengan zero type adalah <code>nil</code>.</p>
<p>Pada kode di atas, jika context adalah <code>nil</code>, maka di-inisialisasi dengan context baru lewat <code>context.Background()</code>.</p>
<p>Objek <code>ctx</code> yang merupakan <code>context.Context</code> di sini kita tempeli data <code>from</code>. Cara melakukannya dengan memanggil statement <code>context.WithValue()</code> dengan disisipi 3 buah parameter.</p>
<ol>
<li>Parameter ke-1, isinya adalah objek context.</li>
<li>Parameter ke-2, isinya key dari data yang akan disimpan.</li>
<li>Parameter ke-3, adalah value data yang akan disimpan.</li>
</ol>
<p>Fungsi <code>.WithValue()</code> di atas mengembalikan objek context, isinya adalah objek context yang disisipkan di parameter pertama pemanggilan fungsi, tapi sudah disisipi data dengan key dari parameter ke-2 dan value dari parameter ke-3. Jadi tampung saja objek context kembalian statement ini ke objek yang sama, yaitu <code>ctx</code>.</p>
<p>Ok, sekarang objek <code>ctx</code> sudah dimodifikasi. Objek ini perlu untuk ditempelkan lagi ke objek request. Caranya dengan mengakses method <code>.WithContext()</code> milik objek request, lalu gunakan nilai baliknya pada <code>next.ServeHTTP()</code>.</p>
<p>Jalankan aplikasi, hasilnya kurang lebih seperti gambar berikut.</p>
<p><img src="images/D_google_api_search_1_context_example.png" alt="Dasar Pemrograman Golang - Context example"></p>
<p>O iya, penulis tidak menggunakan <code>http://localhost</code> untuk mengakses aplikasi, melainkan menggunakan <code>http://mysampletestapp.com</code>, dengan catatan domain ini sudah saya arahkan ke 127.0.0.1.</p>
<p><img src="images/D_google_api_search_2_etc_hosts.png" alt="Dasar Pemrograman Golang - Etc Host"></p>
<p>Ok, untuk sekarang sepertinya cukup jelas mengenai penggunaan context pada objek http request. Tinggal kembangkan saja sesuai kebutuhan, seperti contohnya: context untuk menyimpan data session, yang diambil dari database sessuai dengan session id nya.</p>
<h2 id="d22-context-timeout--cancellation">D.2.2. Context Timeout &amp; Cancellation</h2>
<p>Melanjutkan program yang sudah dibuat, nantinya pada endpoint <code>/api/search</code> akan dilakukan sebuah pencarian ke Google sesuai dengan keyword yang diinginkan. Pencarian dilakukan dengan memanfaatkan <a href="https://developers.google.com/custom-search/json-api/v1/overview" target="_blank">Custom Search JSON API</a> milik Google.</p>
<p>Sekarang ubah isi handler endpoint tersebut menjadi seperti berikut.</p>
<pre><code class="lang-go">mux.HandleFunc(<span class="hljs-string">&quot;/api/search&quot;</span>, <span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
    ctx := r.Context()

    keyword := r.URL.Query().Get(<span class="hljs-string">&quot;keyword&quot;</span>)
    chanRes := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> []<span class="hljs-keyword">byte</span>)
    chanErr := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> error)

    <span class="hljs-keyword">go</span> doSearch(ctx, keyword, chanRes, chanErr)

    <span class="hljs-keyword">select</span> {
    <span class="hljs-keyword">case</span> res := &lt;-chanRes:
        w.Header().Set(<span class="hljs-string">&quot;Content-type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>)
        w.Write(res)
    <span class="hljs-keyword">case</span> err := &lt;-chanErr:
        http.Error(w, err.Error(), http.StatusInternalServerError)
    }
})
</code></pre>
<p>Proses pencarian dilakukan secara <em>asynchronous</em> lewat fungsi <code>doSearch()</code> yang nantinya akan kita buat. Pemanggilannya menggunakan keyword <code>go</code> dan disisipkan beberapa parameter yang dua di antaranya bertipe channel.</p>
<ul>
<li>Channel <code>chanRes</code>, digunakan jika proses pencarian sukses. Data hasil pencarian dilempar ke main routine lewat channel ini, untuk kemudian diteruskan sebagai response endpoint</li>
<li>Channel <code>chanErr</code>, digunakan untuk pass objek error, jika memang terjadi error.</li>
</ul>
<p>Ok, lanjut, siapkan dua buah konstanta baru.</p>
<ul>
<li><p>Konstanta <code>SEARCH_MAX_DURATION</code>, digunakan untuk menge-set max response time. Jika melebihi, maka request langsung di-cancel.</p>
<pre><code class="lang-go"><span class="hljs-keyword">var</span> SEARCH_MAX_DURATION = <span class="hljs-number">4</span> * time.Second
</code></pre>
</li>
<li><p>Konstanta <code>GOOGLE_SEARCH_API_KEY</code>, ini merupakan API key yang diperlukan dalam penggunaan Custom Search API. Silakan merujuk ke laman <a href="https://console.cloud.google.com/apis/dashboard" target="_blank">Google Cloud Platform</a> untuk mendapatkan API key.</p>
<pre><code class="lang-go"><span class="hljs-keyword">var</span> GOOGLE_SEARCH_API_KEY = <span class="hljs-string">&quot;ASSVnHfjD_ltXXXXSyB6WWWWWWWWveMFgE&quot;</span>
</code></pre>
</li>
</ul>
<p>Sekarang kita mulai masuk ke bagian pembuatan fungsi pencarian <code>doSearch()</code>. Silakan tulis kode berikut.</p>
<pre><code class="lang-go"><span class="hljs-keyword">func</span> doSearch(
    ctx context.Context,
    keyword <span class="hljs-keyword">string</span>,
    chanRes <span class="hljs-keyword">chan</span> []<span class="hljs-keyword">byte</span>,
    chanErr <span class="hljs-keyword">chan</span> error,
) {
    innerChanRes := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> []<span class="hljs-keyword">byte</span>)
    innerChanErr := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> error)

    url := <span class="hljs-string">&quot;https://www.googleapis.com/customsearch/v1&quot;</span>
    url = fmt.Sprintf(<span class="hljs-string">&quot;%s?key=%s&quot;</span>, url, GOOGLE_SEARCH_API_KEY)
    url = fmt.Sprintf(<span class="hljs-string">&quot;%s&amp;cx=017576662512468239146:omuauf_lfve&quot;</span>, url)
    url = fmt.Sprintf(<span class="hljs-string">&quot;%s&amp;callback=hndlr&quot;</span>, url)
    url = fmt.Sprintf(<span class="hljs-string">&quot;%s&amp;q=%s&quot;</span>, url, keyword)

    from := ctx.Value(<span class="hljs-string">&quot;from&quot;</span>).(<span class="hljs-keyword">string</span>)

    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>Di dalam fungsi tersebut, <code>url</code> pencarian dibentuk, data API key dan keyword pencarian disisipkan. Selain itu disiapkan pula <code>innerChanRes</code> dan <code>innerChanErr</code> yang kegunaannya mirip seperti objek channel yang disisipkan pada pemanggilan fungsi, hanya saja dua channel baru ini digunakan hanya dalam fungsi ini saja.</p>
<p>Lanjut tulis kode berikut.</p>
<pre><code class="lang-go">ctx, cancel := context.WithTimeout(ctx, SEARCH_MAX_DURATION)
<span class="hljs-keyword">defer</span> cancel()

req, err := http.NewRequest(<span class="hljs-string">&quot;GET&quot;</span>, url, <span class="hljs-literal">nil</span>)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    innerChanErr &lt;- err
    <span class="hljs-keyword">return</span>
}

req = req.WithContext(ctx)
req.Header.Set(<span class="hljs-string">&quot;Referer&quot;</span>, from)

transport := <span class="hljs-built_in">new</span>(http.Transport)
client := <span class="hljs-built_in">new</span>(http.Client)
client.Transport = transport
</code></pre>
<p>Objek <code>ctx</code> yang di-pass dari luar, dibungkus lagi menggunakan <code>context.WithTimeout()</code>. Fungsi ini mengembalikan objek context yang sudah ditambahi data deadline. Tepat setelah statement ini dieksekusi, dalam durasi <code>SEARCH_MAX_DURATION</code> context akan di-cancel.</p>
<blockquote>
<p>Pengesetan deadline context bisa dilakukan lewat <code>context.WithTimeout()</code>, atau bisa juga lewat <code>context.WithDeadline()</code>. Perbedaannya pada fungsi <code>.WithDeadline()</code> parameter yang disisipkan bertipe <code>time.Time</code>.</p>
</blockquote>
<p>Disiapkan juga objek <code>req</code> yang merupakan objek request. Objek ini dibungkus menggunakan <code>req.WithContext()</code> dengan isi parameter objek <code>ctx</code>, menjadikan objek context yang sudah kita buat tertempel pada request ini. Kegunaannya nanti akan dibahas.</p>
<p>Selain itu, data <code>from</code> yang didapat dari request context disisipkan sebagai request header pada objek <code>req</code>.</p>
<p>Disiapkan juga objek <code>transport</code> yang bertipe <code>*http.Transport</code> dan objek <code>client</code> yang bertipe <code>*http.Client</code>.</p>
<p>Setelah ini, tulis kode untuk dispatch request yang sudah dibuat lalu handle response nya. Jalankan proses-nya sebagai goroutine.</p>
<pre><code class="lang-go"><span class="hljs-keyword">go</span> <span class="hljs-keyword">func</span>() {
    resp, err := client.Do(req)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        innerChanErr &lt;- err
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">if</span> resp != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">defer</span> resp.Body.Close()
        resData, err := io.ReadAll(resp.Body)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            innerChanErr &lt;- err
            <span class="hljs-keyword">return</span>
        }
        innerChanRes &lt;- resData
    } <span class="hljs-keyword">else</span> {
        innerChanErr &lt;- errors.New(<span class="hljs-string">&quot;No response&quot;</span>)
    }
}()
</code></pre>
<p>Request di-trigger lewat statement <code>client.Do(req)</code>. Jika menghasilkan error, maka kirim informasi errornya ke channel <code>innerChanErr</code>. Cek juga objek response hasil request tersebut, jika kosong maka lempar sebuah error ke channel yang sama.</p>
<p>Baca response body, jika tidak ada masalah, lempar result-nya ke channel <code>innerChanRes</code>.</p>
<p>Selanjutnya, kita lakukan pengecekan menggunakan teknik <code>select case</code> untuk mengetahui channel mana yang menerima data.</p>
<pre><code class="lang-go"><span class="hljs-keyword">select</span> {
<span class="hljs-keyword">case</span> res := &lt;-innerChanRes:
    chanRes &lt;- res
    <span class="hljs-keyword">return</span>
<span class="hljs-keyword">case</span> err := &lt;-innerChanErr:
    transport.CancelRequest(req)
    chanErr &lt;- err
    <span class="hljs-keyword">return</span>
<span class="hljs-keyword">case</span> &lt;-ctx.Done():
    transport.CancelRequest(req)
    chanErr &lt;- errors.New(<span class="hljs-string">&quot;Search proccess exceed timeout&quot;</span>)
    <span class="hljs-keyword">return</span>
}
</code></pre>
<p>Silakan perhatikan kode di atas, kita akan bahas 2 <code>case</code> pertama.</p>
<ul>
<li>Jika channel <code>innerChanRes</code> mendapati kiriman data, maka langsung diteruskan ke channel <code>chanRes</code>.</li>
<li>Jika channel <code>innerChanErr</code> mendapati kiriman data, maka langsung diteruskan ke channel <code>chanErr</code>. Tak lupa cancel request lewat method <code>transport.CancelRequest(req)</code>, ini diperlukan karena request gagal.</li>
</ul>
<p>Untuk case terakhir <code>case &lt;-ctx.Done()</code>, penjelasannya agak sedikit panjang. Objek context, memiliki method <code>ctx.Done()</code> yang mengembalikan channel. Channel ini akan melewatkan data jika deadline timeout context-nya terpenuhi. Dan jika itu terjadi, pada kode di atas langsung dikembalikan sebuah error ke channel <code>chanErr</code> dengan isi error <code>Search proccess exceed timeout</code>; tak lupa request-nya juga di-cancel.</p>
<p>Request perlu di-cancel karena jika waktu sudah mencapai deadline context (yaitu <code>SEARCH_MAX_DURATION</code>), pada saat tersebut bisa saja request belum selesai, maka dari itu request perlu di-cancel.</p>
<p>Jika di-summary, maka yang dilakukan oleh fungsi <code>doSearch</code> kurang lebih sebagai berikut sebagai berikut.</p>
<ul>
<li>Jika request pencarian tak lebih dari <code>SEARCH_MAX_DURATION</code>:<ul>
<li>Jika hasilnya sukses, maka kembalikan response body lewat channel <code>chanRes</code>.</li>
<li>Jika hasilnya gagal, maka kembalikan error-nya lewat channel <code>chanErr</code>.</li>
</ul>
</li>
<li>Jika request pencarian lebih dari <code>SEARCH_MAX_DURATION</code>, maka dianggap <em>timeout</em>, langsung lempar error timeout ke channel <code>chanErr</code>.</li>
</ul>
<p>Jalankan, lihat hasilnya.</p>
<p><img src="images/D_google_api_search_3_result_ok.png" alt="Dasar Pemrograman Golang - Request response OK"></p>
<p>Informasi tambahan: best practice mengenai cancelation context adalah untuk selalu menambahkan <code>defer cancel()</code> setelah (cancelation) context dibuat. Lebih detailnya silakan baca <a href="https://blog.golang.org/context" target="_blank">https://blog.golang.org/context</a>.</p>
<h2 id="d23-google-search-api-restrictions-referer">D.2.3. Google Search API Restrictions Referer</h2>
<p>Di bagian awal chapter ini, kita belajar mengenai context value. Kenapa penulis memilih menggunakan context untuk menyisipkan data referer, kenapa tidak contoh yg lebih umum seperti session dan lainnya? sebenarnya ada alasannya.</p>
<p>Silakan coba akses kedua url berikut.</p>
<ul>
<li><a href="http://mysampletestapp.com/api/search?keyword=golang" target="_blank">http://mysampletestapp.com/api/search?keyword=golang</a></li>
<li><a href="http://localhost/api/search?keyword=golang" target="_blank">http://localhost/api/search?keyword=golang</a></li>
</ul>
<p>Harusnya yang dikembalikan sama, tapi kenyataannya pengaksesan lewat url <code>localhost</code> menghasilkan error.</p>
<p><img src="images/D_google_api_search_4_result_fail.png" alt="Dasar Pemrograman Golang - Request response fail"></p>
<p>Error message:</p>
<pre style="font-size: .85em; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;">The referrer localhost does not match the referrer restrictions configured on your API key. Please use the API Console to update your key restrictions.</pre>

<p>Error di atas muncul karena, host <code>localhost</code> belum didaftarkan pada API console. Berbeda dengan <code>mysampletestapp.com</code> yang sudah didaftarkan, host ini berhak mengakses menggunakan API key yang kita gunakan.</p>
<p><img src="images/D_google_api_search_5_api_hostname.png" alt="Dasar Pemrograman Golang - Api configuration"></p>
<hr>
<div class="source-code-link">
    <div class="source-code-link-message">Source code praktik chapter ini tersedia di Github</div>
    <a href="https://github.com/novalagung/dasarpemrogramangolang-example/tree/master/chapter-D.2-google-api-search/2-request-cancellation" target="_blank">https://github.com/novalagung/dasarpemrogramangolang-example/...</a>
</div>

<hr>
<iframe src="partial/ebooks.html" width="100%" height="390px" frameborder="0" scrolling="no"></iframe>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="D-insert-1mil-csv-record-into-db-in-a-minute.html" class="navigation navigation-prev " aria-label="Previous page: D.1. Insert 1 Juta Data dari File CSV Ke Database Server, Menggunakan Teknik Worker Pool, Database Connection Pool, dan Mekanisme Failover">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="D-golang-web-socket-chatting-app.html" class="navigation navigation-next " aria-label="Next page: D.3. Web Socket: Chatting App">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"D.2. Google API Search Dengan Timeout","level":"6.1.2","depth":2,"next":{"title":"D.3. Web Socket: Chatting App","level":"6.1.3","depth":2,"path":"D-golang-web-socket-chatting-app.md","ref":"D-golang-web-socket-chatting-app.md","articles":[]},"previous":{"title":"D.1. Insert 1 Juta Data dari File CSV Ke Database Server, Menggunakan Teknik Worker Pool, Database Connection Pool, dan Mekanisme Failover","level":"6.1.1","depth":2,"path":"D-insert-1mil-csv-record-into-db-in-a-minute.md","ref":"D-insert-1mil-csv-record-into-db-in-a-minute.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-search","-lunr","docsearch-v3","disqus","meta","sitemap"],"pluginsConfig":{"docsearch":{"appId":"ZV0MXP90GF","apiKey":"f7431c709385fe300da4c2ef2093c43c","indexName":"dasarpemrogramangolang-novalagung"},"disqus":{"useIdentifier":false,"shortName":"dasarpemrogramangolang"},"meta":{"name":"","content":"","data":[{"name":"google-site-verification","content":"UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE"},{"name":"og:image","content":"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"},{"name":"twitter:image","content":"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"}]},"docsearch-v3":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"hostname":"https://dasarpemrogramangolang.novalagung.com/"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":10,"left":10,"top":56,"bottom":56}},"styles":{"website":"style-website-v3.css"}},"file":{"path":"D-google-api-search.md","mtime":"2024-11-27T07:32:07.760Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-11-27T07:33:04.144Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-docsearch-v3/init.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <div style="position: fixed; top: 5px; right: 30px; padding: 10px; background-color: rgba(255, 255, 255, 0.7);">
			<a class="github-button" href="https://github.com/sponsors/novalagung" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @novalagung on GitHub">Sponsor</a>&nbsp;
			<a class="github-button" href="https://github.com/novalagung/dasarpemrogramangolang" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star novalagung/dasarpemrogramangolang on GitHub">Star</a>&nbsp;
			<a class="github-button" href="https://github.com/novalagung" data-size="large" aria-label="Follow @novalagung on GitHub">Follow @novalagung</a>
			<script async defer src="https://buttons.github.io/buttons.js"></script>
		</div></body>
</html>